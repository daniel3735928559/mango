<!DOCTYPE html>
<html>
    <head>
	<title>CAFE</title>
	<link rel="stylesheet" href="css/cafe.css">
	<link rel="stylesheet" href="css/cafe-light.css">
	<link rel="stylesheet" href="node_modules/bootstrap/dist/css/bootstrap.min.css">
	<link rel="stylesheet" href="node_modules/vis/dist/vis-network.min.css">
	<script type="text/javascript" src="/mangojs/reconnecting-websocket.min.js"></script>
	<script type="text/javascript" src="/mangojs/mu.js"></script>
	<script type="text/javascript" src="node_modules/vue/dist/vue.js"></script>
	<script type="text/javascript" src="node_modules/sortablejs/Sortable.min.js"></script>
	<script type="text/javascript" src="node_modules/vis/dist/vis.js"></script>
	<script type="text/javascript" src="js/shellquote.js"></script>
	<script type="text/javascript" src="js/cafe.js"></script>
    </head>
    <body>
	<div id="app" class="container-full-width">
	    <div id="main" class="row">
		<div class="col-md-5 offset-md-1">
		    <div id="main_col">
			<div id="modes">
			    <div v-bind:style="{ 'background-color' : mode == m ? '#ccf' : '#fff' }" v-for="m in ['nodes', 'types', 'groups', 'emp', 'graph', 'detail']" v-on:click="set_mode(m)">{{m == 'detail' ? detail_node : m}}</div>
			</div>
			<div v-if="mode == 'types'" id="types">
			    <h4>Types</h4>
			    <ul>
				<li v-for="t in types"><a href="#" v-on:click="cmd = 'addnode ' + t.name">{{t.name}}</a>: {{t.desc}}</li>
			    </ul>
			</div>
			<div v-if="mode == 'emp'" id="emps">
			    <h4>Emps</h4>
			    <ul>
				<li v-for="e in emps"><a href="#" v-on:click="cmd = 'startemp ' + e.name">{{e.name}}</a></li>
			    </ul>
			</div>
			<div v-if="mode == 'groups'" id="groups">
			    <h4>Groups</h4>
			    <ul>
				<li v-for="group,group_name in groups">{{group_name}}: 
				    <ul>
					<li v-for="n in group"><a href="#" v-on:click="details(g+'/'+n)">{{n}}</a></li>
				    </ul>
				</li>
			    </ul>
			</div>
			<div v-if="mode == 'nodes'" id="nodes">
			    <h4>Nodes</h4>
			    <div v-for="name in sorted_nodes()">
				<a :name="name" />
				<h4><a href="#" v-on:click="details(name)">{{name}}</a> ({{nodes[name].node_type}}) 
				    <a href="#" v-on:click="cmd = 'delnode ' + name">[x]</a></h4>
				<ul>
				    <li v-for="r in nodes[name].routes">
					{{r.src}}
					<span v-if="r.edits">&gt; {{r.edits}}</span> &gt;
					<a href="#" v-on:click="details(r.dst)">{{r.dst}}</a>
					<a href="#" v-on:click="cmd = 'delroute ' + r.src + ' ' + r.dst + ' ' + r.group">[x]</a>
				    </li>
				</ul>
			    </div>
			</div>
			
			<div v-if="mode == 'detail'" id="detail">
			    <h2>Connected to: {{nodes[detail_node].group}}/{{nodes[detail_node].name}}</h2>
			    <h4>Type: {{nodes[detail_node].node_type}}</h4>
			    <h4>Routes:</h4>
			    <ul>
				<li v-for="r in nodes[detail_node].routes">{{r.src}} <span v-if="r.edits">&gt; {{r.edits}}</span> &gt; <a href="#" v-on:click="details(r.dst)">{{r.dst}}</a></li>
			    </ul>
			    <div v-if="nodes[detail_node].interface">
				<h4>Interface:</h4>
				Inputs:
				<ul>
				    <li v-for="(spec,name) in nodes[detail_node].interface.inputs">{{name}} {{spec}}</li>
				</ul>
				Outputs:
				<ul>
				    <li v-for="(spec,name) in nodes[detail_node].interface.outputs">{{name}} {{spec}}</li>
				</ul>
			    </div>
			</div>

			<!-- graph -->
			<div id="graph" v-if="mode == 'graph'">
			</div>
		    </div>
		</div>	
		<!-- sidebar -->
		<div class="col-md-5">
		    <simple-shell :commands="shell_commands" :run_cb="run_cmd" v-model="cmd"></simple-shell>
		</div>


		
	    </div>
	</div>
    </body>
</html>    
